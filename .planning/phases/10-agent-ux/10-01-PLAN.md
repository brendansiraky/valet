---
phase: 10-agent-ux
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - app/services/capabilities/text-generation.server.ts
  - app/services/capabilities/web-search.server.ts
  - app/services/capabilities/url-fetch.server.ts
  - app/db/schema/agents.ts
  - app/routes/pipelines.$id.tsx
autonomous: true

must_haves:
  truths:
    - "No dead code exists in capabilities directory"
    - "Only runWithTools remains as the unified capability runner"
    - "No debug console.log statements in pipeline page"
    - "Application still compiles and runs without errors"
  artifacts:
    - path: "app/services/capabilities/"
      provides: "Unified tool runner only"
      contains: "run-with-tools.server.ts"
    - path: "app/db/schema/agents.ts"
      provides: "Agent schema without unused types"
  key_links:
    - from: "app/services/agent-runner.server.ts"
      to: "app/services/capabilities/run-with-tools.server.ts"
      via: "import runWithTools"
      pattern: "from.*run-with-tools"
    - from: "app/services/pipeline-executor.server.ts"
      to: "app/services/capabilities/run-with-tools.server.ts"
      via: "import runWithTools"
      pattern: "from.*run-with-tools"
---

<objective>
Delete unused capability service files and remove dead code artifacts from the old capability system.

Purpose: Clean up technical debt from the capability system evolution. The unified runWithTools pattern replaced individual capability runners, leaving three unused files and an unused type export.

Output: Cleaner codebase with only active code in the capabilities directory.
</objective>

<execution_context>
@/Users/brendan/.claude/get-shit-done/workflows/execute-plan.md
@/Users/brendan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-agent-ux/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete unused capability service files</name>
  <files>
    app/services/capabilities/text-generation.server.ts
    app/services/capabilities/web-search.server.ts
    app/services/capabilities/url-fetch.server.ts
  </files>
  <action>
Delete the three unused capability service files:
- `rm app/services/capabilities/text-generation.server.ts` (exports generateText - never imported)
- `rm app/services/capabilities/web-search.server.ts` (exports runWithWebSearch - never imported)
- `rm app/services/capabilities/url-fetch.server.ts` (exports runWithUrlFetch - never imported)

These files are dead code. The unified `runWithTools` in `run-with-tools.server.ts` has replaced all individual capability runners. Verified by research that no imports exist for these files anywhere in the codebase.

After deletion, the capabilities directory should contain only `run-with-tools.server.ts`.
  </action>
  <verify>
Run `ls app/services/capabilities/` - should show only `run-with-tools.server.ts`
Run `npm run typecheck` - should pass (no broken imports)
  </verify>
  <done>
Only run-with-tools.server.ts remains in capabilities directory. TypeScript compilation succeeds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove unused AgentCapability type and debug console.log</name>
  <files>
    app/db/schema/agents.ts
    app/routes/pipelines.$id.tsx
  </files>
  <action>
1. In `app/db/schema/agents.ts`:
   - Remove line 4: `export type AgentCapability = "none" | "search" | "fetch";`
   - This type is never imported or used anywhere in the application
   - Keep the `capability` column in the table (removing columns requires migration)

2. In `app/routes/pipelines.$id.tsx`:
   - Find and remove the debug console.log on line ~285: `console.log("Pipeline completed:", finalOutput);`
   - Keep the console.error statements (those are legitimate error logging)

Note: The three TODO comments for toast errors can remain - sonner is not installed and adding toast infrastructure is out of scope for this cleanup phase.
  </action>
  <verify>
Run `grep -r "AgentCapability" app/` - should return no results
Run `grep "console.log.*Pipeline completed" app/routes/pipelines.$id.tsx` - should return no results
Run `npm run typecheck` - should pass
  </verify>
  <done>
AgentCapability type removed from schema. Debug console.log removed from pipeline page. TypeScript compilation succeeds.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run typecheck` passes
2. `npm run dev` starts without errors
3. Only `run-with-tools.server.ts` exists in `app/services/capabilities/`
4. No `AgentCapability` type export exists
5. No debug console.log in pipeline page
</verification>

<success_criteria>
- Capabilities directory contains only `run-with-tools.server.ts`
- Schema file no longer exports `AgentCapability` type
- Pipeline page has no debug console.log
- Application compiles and runs without errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-agent-ux/10-01-SUMMARY.md`
</output>
